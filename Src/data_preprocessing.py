# -*- coding: utf-8 -*-
"""Data_Preprocessing.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1DKdO3zRSM9YHfTcrhRHKmTd49tD0PLn8
"""

import pandas as pd
from google.colab import files

# 1. Upload file in Colab
print("ðŸ“‚ Please upload Telco-Customer-Churn.csv file")
uploaded = files.upload()
filename = list(uploaded.keys())[0]

# 2. Load dataset
def load_data(path):
    return pd.read_csv(path)

# 3. Preprocess dataset
def preprocess_data(df):
    # Drop customerID (not useful for ML)
    if 'customerID' in df.columns:
        df = df.drop('customerID', axis=1)

    # Convert TotalCharges to numeric
    if 'TotalCharges' in df.columns:
        df['TotalCharges'] = pd.to_numeric(df['TotalCharges'], errors='coerce')
        df = df.fillna(0)

    # Encode categorical variables
    df = pd.get_dummies(df, drop_first=True)
    return df

# 4. Run pipeline
df = load_data(filename)
clean_df = preprocess_data(df)
clean_df.to_csv("churn_clean.csv", index=False)

print("âœ… Data preprocessing completed. File saved as churn_clean.csv")