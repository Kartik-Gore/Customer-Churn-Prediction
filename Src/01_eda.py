# -*- coding: utf-8 -*-
"""01_EDA.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1kz8n0s3mwrd9fr2QUF_Gfxp5sJuDDe31
"""

# 01_EDA.ipynb

# ========================
# 1. Import Libraries
# ========================
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# For file upload in Google Colab
from google.colab import files

# ========================
# 2. Upload Dataset
# ========================
print("ðŸ“‚ Please upload your dataset (CSV file)")
uploaded = files.upload()

# Get the first uploaded file name
file_name = list(uploaded.keys())[0]

# Read the uploaded CSV
df = pd.read_csv(file_name)

# ========================
# 3. Quick Overview
# ========================
print("Dataset Shape:", df.shape)
display(df.head())

# Missing values check
print("\nMissing Values:\n", df.isnull().sum())

# Data types
print("\nData Types:")
df.info()

# ========================
# 4. Descriptive Statistics
# ========================
display(df.describe())

# ========================
# 5. Univariate Analysis
# ========================
# Target variable distribution
if "Churn" in df.columns:
    sns.countplot(x="Churn", data=df)
    plt.title("Churn Distribution")
    plt.show()

    # Numerical features
    df.hist(figsize=(12, 8))
    plt.show()

    # ========================
    # 6. Correlation Heatmap
    # ========================
    plt.figure(figsize=(10,6))
    sns.heatmap(df.corr(numeric_only=True), annot=True, cmap="coolwarm")
    plt.title("Correlation Heatmap")
    plt.show()

    # ========================
    # 7. Categorical Analysis
    # ========================
    for col in df.select_dtypes(include="object").columns:
        if col != "Churn":  # Skip target variable if it's categorical
            plt.figure(figsize=(6,4))
            sns.countplot(x=col, hue="Churn", data=df)
            plt.title(f"{col} vs Churn")
            plt.xticks(rotation=45)
            plt.show()